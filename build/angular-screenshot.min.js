/*! Angular Screenshot - v0.1.0 - http://weihanchen.github.io/angular-screenshot - (c) 2017 weihanchen - MIT */
!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=10)}([function(e,t,n){"use strict";var r=n(9),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(r),i=n(2);o.module("angular-screenshot",[]).directive("screenshot",i.screenshot).directive("screenshotToolbox",i.screenshotToolbox)},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.screenshotToolbox=t.screenshot=void 0;var o=n(4),i=r(o),u=n(3),a=r(u);t.screenshot=i.default,t.screenshotToolbox=a.default,t.default={screenshot:i.default,screenshotToolbox:a.default}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return{restruct:"E",template:'<div class="screenshot-toolbox-custom" ng-transclude></div>',require:"^screenshot",link:function(e,t,n,r){var o="<div>"+t.children().html()+"</div>";r.setTemplate(o,e),t.remove()},transclude:!0}};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),o=n(8),i=function(e){return e&&e.__esModule?e:{default:e}}(o),u=function(){return{restrict:"AE",scope:{target:"@",isOpen:"=",toolboxOptions:"=?",api:"=?"},controller:["$scope","$element","$compile","$timeout",function(e,t,n,o){var u={gray:"#898b89",lightGray:"#e6e3e3"},a={top:1,second:0},c=this,s=function(e,t,n,r,o){var i=e+n.startX+n.w,u=t+n.startY+n.h;return n.w>=0&&(i-=r),n.h>=0?u+=5:u=u-o-5,{left:i,top:u}},l=function(){r.domprocess.remove(c.toolboxElement),r.domprocess.clearCanvasRect(c.interactiveCanvas)},f=function(){c.isOpen=!1,o(function(){var e=h(),t=e[0],n=p(t);i.default.toPng(t,n).then(r.domprocess.dataUrlToImage).then(function(e){return r.domprocess.clipImageToCanvas(e,c.rect.startX,c.rect.startY,c.rect.w,c.rect.h)}).then(function(e){return r.domprocess.downloadCanvas(e,c.filename)}).then(r.domprocess.remove)})},d=function(){var e=0;return angular.element("body *").each(function(){var t=angular.element(this).css("zIndex");t>e&&(e=t)}),e},h=function(){return c.target?angular.element(c.target):t.children().filter(function(e,t){return"screenshot-toolbox"!==t.tagName.toLowerCase()})},p=function(e){var t=e.getBoundingClientRect(),n={width:t.width,height:t.height};if(r.domprocess.isTransparent(e)){var o=r.domprocess.getStyle(e,"backgroundColor");n=Object.assign({},n,{bgcolor:o})}return n},m=function(){var e=d();a.second=e+1,a.top=a.second+1},g=function(){r.domprocess.remove(c.toolboxElement)},v=function(t,o){if(0!=o.w&&0!=o.h){r.domprocess.remove(c.toolboxElement),c.rect=o;var i=n(c.template)(c.templateScope);e.$apply();var u=i[0];r.domprocess.setToolboxStackStyle(u,a.top).then(r.domprocess.appendToBody).then(function(e){var n=s(t.offsetLeft,t.offsetTop,o,e.offsetWidth,e.offsetHeight);return r.domprocess.setToolboxPositionStyle(e,n.left,n.top)}).then(function(e){c.toolboxElement=e})}},y=function(){c.isOpen=!1,e.$apply()},w=function(){r.domprocess.remove(c.interactiveCanvas),r.domprocess.remove(c.toolboxElement)},b=function(){var e=h(),t=e.outerWidth(!0),n=e.outerHeight(!0),o=e.offset(),i=o.left,s=o.top;m(),r.domprocess.createCanvas(t,n).then(function(e){return r.domprocess.setCanvasStyle(e,i,s,u.gray,a.second)}).then(r.domprocess.appendToBody).then(function(e){return r.domprocess.listenInteractiveCanvas(e,u.lightGray,v,g,y)}).then(function(e){return c.interactiveCanvas=e})},x=function(e,t){c.template=e,c.templateScope=t};c.cancel=l,c.download=f,c.interactiveCanvas,c.rect={},c.toolboxElement,c.cancelText="Cancel",c.downloadText="Download",c.filename="screenshot.png",c.setTemplate=x,c.template='<div class="screenshot-toolbox"><button class="btn" type="button" ng-click="screenshotCtrl.cancel()">{{screenshotCtrl.cancelText}}</button><button class="btn" type="button" ng-click="screenshotCtrl.download()">{{screenshotCtrl.downloadText}}</button></div>',c.templateScope=e,o(function(){return c.api={download:f,cancel:l}}),e.$watch(function(){return c.isOpen},function(e){e===!0?b():e===!1&&w()}),e.$watch(function(){return c.toolboxOptions},function(e){angular.isObject(e)&&(c.cancelText=e.cancelText?e.cancelText:c.cancelText,c.downloadText=e.downloadText?e.downloadText:c.downloadText,c.filename=e.filename?e.filename:c.filename)})}],controllerAs:"screenshotCtrl",bindToController:!0}};t.default=u},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0});var o=/url\(['"]?([^'"]+?)['"]?\)/g,i=function(e){return m(e).then(function(t){var n=document.createElement("style");return e.appendChild(n),n.appendChild(document.createTextNode(t)),e})},u=function(e,t,n){var r=new RegExp("(url\\(['\"]?)("+c(t)+")(['\"]?\\))","g");return e.replace(r,"$1"+n+"$3")},a=function(e,t){return"data:"+t+";base64,"+e},c=function(e){return e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")},s=function(e){return new Promise(function(t){var n=new XMLHttpRequest,r=function(e){console.error(e),t("")};n.onreadystatechange=function(){if(4===n.readyState){if(200!==n.status)return void r("cannot fetch resource: "+e+", status: "+n.status);var o=new FileReader;o.onloadend=function(){t(o.result.split(/,/)[1])},o.readAsDataURL(n.response)}},n.ontimeout=function(){r("timeout of 30000ms occured while fetching resource: "+e)},n.responseType="blob",n.timeout=3e4,n.open("GET",e,!0),n.send()})},l=function(e){var t=/\.([^\.\/]*?)$/g.exec(e);return t?t[1]:""},f=function(e,t,n){return Promise.resolve(t).then(function(e){return n?C(e,n):e}).then(s).then(function(e){return a(e,g(t))}).then(function(n){return u(e,t,n)})},d=function(e){var t=e.parentStyleSheet?e.parentStyleSheet.href:e.parentStyleSheet,n=e.cssText;return P(n)?Promise.resolve(n).then(b).then(function(e){var r=Promise.resolve(n);return e.forEach(function(e){r=r.then(function(n){return f(n,e,t)})}),r}):Promise.resolve(n)},h=function(e){return new Promise(function(t,n){var r=new Image;r.onload=function(){t(r)},r.onerror=n,r.src=e})},p=function(){var e=document.styleSheets;if(!e)return Promise.resolve([]);var t=T(e),n=t.reduce(function(e,t){var n=t.rules||t.cssRules;if(n){var o=T(n);e.push.apply(e,r(o))}return e},[]);return Promise.resolve(n)},m=function(){return p().then(function(e){return e.map(function(e){return d(e)})}).then(function(e){return Promise.all(e)}).then(function(e){return e.join("\n")})},g=function(e){var t={woff:"application/font-woff",woff2:"application/font-woff",ttf:"application/font-truetype",png:"image/png",jpeg:"image/jpeg",gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"},n=l(e).toLowerCase();return t.hasOwnProperty(n)?t[n]:""},v=function(e){return Promise.resolve(e).then(function(e){return e.setAttribute("xmlns",e.namespaceURI),(new XMLSerializer).serializeToString(e)}).then(function(e){return"<foreignObject x='0' y='0' width='100%' height='100%'>"+e+"</foreignObject>"}).then(function(e){return"<svg xmlns='http://www.w3.org/2000/svg'>"+e+"</svg>"}).then(function(e){return"data:image/svg+xml;charset=utf-8,"+e})},y=function(e,t){t=t||{};var n=e.cloneNode(!0),r=e.getBoundingClientRect(),o=r.width,u=r.height;return Promise.resolve(n).then(i).then(v).then(h).then(function(e){var n=document.createElement("canvas");return n.width=t.width||o,n.height=t.height||u,n.getContext("2d").drawImage(e,0,0),n})},w=function(e){var t=e.cloneNode(!0);return Promise.resolve(t).then(i).then(v).then(h)},b=function(e){for(var t=[],n=void 0;null!==(n=o.exec(e));)t.push(n[1]);return t.filter(function(e){return!x(e)})},x=function(e){return e.search(/^(data:)/)!==-1},P=function(e){return e.search(o)!==-1},T=function(e){return Object.keys(e).map(function(t){return e[t]})},C=function(e,t){var n=document.implementation.createHTMLDocument(),r=n.createElement("base");n.head.appendChild(r);var o=n.createElement("a");return n.body.appendChild(o),r.href=t,o.href=e,o.href},E={getCanvas:y,getCanvasImage:w};t.default=E},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return document.body.appendChild(e),Promise.resolve(e)},o=function(e){return a(e.toDataURL("image/png"))},i=function(e){e.getContext("2d").clearRect(0,0,e.width,e.height)},u=function(e,t,n,r,o){return s(Math.abs(r),Math.abs(o)).then(function(i){return i.getContext("2d").drawImage(e,t,n,r,o,0,0,i.width,i.height),i})},a=function(e){return new Promise(function(t,n){var r=new Image;r.onload=function(){t(r)},r.onerror=n,r.src=e})},c=function(e,t){var n=e.toDataURL("image/png"),r=document.createElement("a");return r.href=n,r.download=t,r.target="_blank",r.click(),r.remove(),Promise.resolve(e)},s=function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,Promise.resolve(n)},l=function(e,t){return window.getComputedStyle(e)[t]},f=function(e){var t=window.getComputedStyle(e).backgroundColor;return"transparent"===t||""===t||"rgba(0,0,0,0)"===t},d=function(e,t,n,r,o){var i=e.getContext("2d"),u={startX:0,startY:0,w:0,h:0},a=!1,c=function(){i.beginPath(),i.fillStyle=t,i.fillRect(u.startX,u.startY,u.w,u.h),i.closePath()},s=function(t){i.clearRect(0,0,e.width,e.height),u.startX=t.pageX-e.offsetLeft,u.startY=t.pageY-e.offsetTop,r(u),u.w=0,u.h=0,a=!0},l=function(t){a&&(u.w=t.pageX-e.offsetLeft-u.startX,u.h=t.pageY-e.offsetTop-u.startY,i.clearRect(0,0,e.width,e.height),c())},f=function(){a=!1,n(e,u)},d=function(e){return o(),e.preventDefault(),!1};return e.addEventListener("mousedown",s,!1),e.addEventListener("mouseup",f,!1),e.addEventListener("mousemove",l,!1),e.addEventListener("contextmenu",d,!1),Promise.resolve(e)},h=function(e){e&&e.remove()},p=function(e,t,n,r,o){return e.style.cursor="crosshair",e.style.position="absolute",e.style.left=t+"px",e.style.top=n+"px",e.style.background=r,e.style.zIndex=o,e.style.opacity=.5,Promise.resolve(e)},m=function(e,t,n){return e.style.left=t+"px",e.style.top=n+"px",Promise.resolve(e)},g=function(e,t){return e.style.position="absolute",e.style.zIndex=t,Promise.resolve(e)},v={appendToBody:r,canvasToImage:o,clearCanvasRect:i,clipImageToCanvas:u,createCanvas:s,dataUrlToImage:a,downloadCanvas:c,getStyle:l,isTransparent:f,listenInteractiveCanvas:d,remove:h,setCanvasStyle:p,setToolboxPositionStyle:m,setToolboxStackStyle:g};t.default=v},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.domprocess=t.domcapture=void 0;var o=n(5),i=r(o),u=n(6),a=r(u);t.domcapture=i.default,t.domprocess=a.default,t.default={domcapture:i.default,domprocess:a.default}},function(e,t,n){!function(t){"use strict";function n(e,t){function n(e){return t.bgcolor&&(e.style.backgroundColor=t.bgcolor),t.width&&(e.style.width=t.width+"px"),t.height&&(e.style.height=t.height+"px"),t.style&&Object.keys(t.style).forEach(function(n){e.style[n]=t.style[n]}),e}return t=t||{},Promise.resolve(e).then(function(e){return c(e,t.filter,!0)}).then(s).then(l).then(n).then(function(n){return f(n,t.width||d.width(e),t.height||d.height(e))})}function r(e,t){return a(e,t||{}).then(function(t){return t.getContext("2d").getImageData(0,0,d.width(e),d.height(e)).data})}function o(e,t){return a(e,t||{}).then(function(e){return e.toDataURL()})}function i(e,t){return t=t||{},a(e,t).then(function(e){return e.toDataURL("image/jpeg",t.quality||1)})}function u(e,t){return a(e,t||{}).then(d.canvasToBlob)}function a(e,t){function r(e){var n=document.createElement("canvas");if(n.width=t.width||d.width(e),n.height=t.height||d.height(e),t.bgcolor){var r=n.getContext("2d");r.fillStyle=t.bgcolor,r.fillRect(0,0,n.width,n.height)}return n}return n(e,t).then(d.makeImage).then(d.delay(100)).then(function(t){var n=r(e);return n.getContext("2d").drawImage(t,0,0),n})}function c(e,t,n){function r(e){return e instanceof HTMLCanvasElement?d.makeImage(e.toDataURL()):e.cloneNode(!1)}function o(e,t,n){var r=e.childNodes;return 0===r.length?Promise.resolve(t):function(e,t,n){var r=Promise.resolve();return t.forEach(function(t){r=r.then(function(){return c(t,n)}).then(function(t){t&&e.appendChild(t)})}),r}(t,d.asArray(r),n).then(function(){return t})}function i(e,t){function n(){!function(e,t){e.cssText?t.cssText=e.cssText:function(e,t){d.asArray(e).forEach(function(n){t.setProperty(n,e.getPropertyValue(n),e.getPropertyPriority(n))})}(e,t)}(window.getComputedStyle(e),t.style)}function r(){function n(n){var r=window.getComputedStyle(e,n),o=r.getPropertyValue("content");if(""!==o&&"none"!==o){var i=d.uid();t.className=t.className+" "+i;var u=document.createElement("style");u.appendChild(function(e,t,n){var r="."+e+":"+t,o=n.cssText?function(e){var t=e.getPropertyValue("content");return e.cssText+" content: "+t+";"}(n):function(e){function t(t){return t+": "+e.getPropertyValue(t)+(e.getPropertyPriority(t)?" !important":"")}return d.asArray(e).map(t).join("; ")+";"}(n);return document.createTextNode(r+"{"+o+"}")}(i,n,r)),t.appendChild(u)}}[":before",":after"].forEach(function(e){n(e)})}function o(){e instanceof HTMLTextAreaElement&&(t.innerHTML=e.value),e instanceof HTMLInputElement&&t.setAttribute("value",e.value)}function i(){t instanceof SVGElement&&(t.setAttribute("xmlns","http://www.w3.org/2000/svg"),t instanceof SVGRectElement&&["width","height"].forEach(function(e){var n=t.getAttribute(e);n&&t.style.setProperty(e,n)}))}return t instanceof Element?Promise.resolve().then(n).then(r).then(o).then(i).then(function(){return t}):t}return n||!t||t(e)?Promise.resolve(e).then(r).then(function(n){return o(e,n,t)}).then(function(t){return i(e,t)}):Promise.resolve()}function s(e){return p.resolveAll().then(function(t){var n=document.createElement("style");return e.appendChild(n),n.appendChild(document.createTextNode(t)),e})}function l(e){return m.inlineAll(e).then(function(){return e})}function f(e,t,n){return Promise.resolve(e).then(function(e){return e.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),(new XMLSerializer).serializeToString(e)}).then(d.escapeXhtml).then(function(e){return'<foreignObject x="0" y="0" width="100%" height="100%">'+e+"</foreignObject>"}).then(function(e){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+t+'" height="'+n+'">'+e+"</svg>"}).then(function(e){return"data:image/svg+xml;charset=utf-8,"+e})}var d=function(){function e(){var e="application/font-woff";return{woff:e,woff2:e,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}function t(e){var t=/\.([^\.\/]*?)$/g.exec(e);return t?t[1]:""}function n(n){var r=t(n).toLowerCase();return e()[r]||""}function r(e){return e.search(/^(data:)/)!==-1}function o(e){return new Promise(function(t){for(var n=window.atob(e.toDataURL().split(",")[1]),r=n.length,o=new Uint8Array(r),i=0;i<r;i++)o[i]=n.charCodeAt(i);t(new Blob([o],{type:"image/png"}))})}function i(e){return e.toBlob?new Promise(function(t){e.toBlob(t)}):o(e)}function u(e,t){var n=document.implementation.createHTMLDocument(),r=n.createElement("base");n.head.appendChild(r);var o=n.createElement("a");return n.body.appendChild(o),r.href=t,o.href=e,o.href}function a(e){return new Promise(function(t,n){var r=new Image;r.onload=function(){t(r)},r.onerror=n,r.src=e})}function c(e){var t=3e4;return new Promise(function(n){function r(){if(4===u.readyState){if(200!==u.status)return void i("cannot fetch resource: "+e+", status: "+u.status);var t=new FileReader;t.onloadend=function(){n(t.result.split(/,/)[1])},t.readAsDataURL(u.response)}}function o(){i("timeout of "+t+"ms occured while fetching resource: "+e)}function i(e){console.error(e),n("")}var u=new XMLHttpRequest;u.onreadystatechange=r,u.ontimeout=o,u.responseType="blob",u.timeout=t,u.open("GET",e,!0),u.send()})}function s(e,t){return"data:"+t+";base64,"+e}function l(e){return e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")}function f(e){return function(t){return new Promise(function(n){setTimeout(function(){n(t)},e)})}}function d(e){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}function h(e){return e.replace(/#/g,"%23").replace(/\n/g,"%0A")}function p(e){var t=g(e,"border-left-width"),n=g(e,"border-right-width");return e.scrollWidth+t+n}function m(e){var t=g(e,"border-top-width"),n=g(e,"border-bottom-width");return e.scrollHeight+t+n}function g(e,t){var n=window.getComputedStyle(e).getPropertyValue(t);return parseFloat(n.replace("px",""))}return{escape:l,parseExtension:t,mimeType:n,dataAsUrl:s,isDataUrl:r,canvasToBlob:i,resolveUrl:u,getAndEncode:c,uid:function(){var e=0;return function(){return"u"+function(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}()+e++}}(),delay:f,asArray:d,escapeXhtml:h,makeImage:a,width:p,height:m}}(),h=function(){function e(e){return e.search(o)!==-1}function t(e){for(var t,n=[];null!==(t=o.exec(e));)n.push(t[1]);return n.filter(function(e){return!d.isDataUrl(e)})}function n(e,t,n,r){function o(e){return new RegExp("(url\\(['\"]?)("+d.escape(e)+")(['\"]?\\))","g")}return Promise.resolve(t).then(function(e){return n?d.resolveUrl(e,n):e}).then(r||d.getAndEncode).then(function(e){return d.dataAsUrl(e,d.mimeType(t))}).then(function(n){return e.replace(o(t),"$1"+n+"$3")})}function r(r,o,i){return function(){return!e(r)}()?Promise.resolve(r):Promise.resolve(r).then(t).then(function(e){var t=Promise.resolve(r);return e.forEach(function(e){t=t.then(function(t){return n(t,e,o,i)})}),t})}var o=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:r,shouldProcess:e,impl:{readUrls:t,inline:n}}}(),p=function(){function e(){return t(document).then(function(e){return Promise.all(e.map(function(e){return e.resolve()}))}).then(function(e){return e.join("\n")})}function t(){function e(e){return e.filter(function(e){return e.type===CSSRule.FONT_FACE_RULE}).filter(function(e){return h.shouldProcess(e.style.getPropertyValue("src"))})}function t(e){var t=[];return e.forEach(function(e){try{d.asArray(e.cssRules||[]).forEach(t.push.bind(t))}catch(t){console.log("Error while reading CSS rules from "+e.href,t.toString())}}),t}function n(e){return{resolve:function(){var t=(e.parentStyleSheet||{}).href;return h.inlineAll(e.cssText,t)},src:function(){return e.style.getPropertyValue("src")}}}return Promise.resolve(d.asArray(document.styleSheets)).then(t).then(e).then(function(e){return e.map(n)})}return{resolveAll:e,impl:{readAll:t}}}(),m=function(){function e(e){function t(t){return d.isDataUrl(e.src)?Promise.resolve():Promise.resolve(e.src).then(t||d.getAndEncode).then(function(t){return d.dataAsUrl(t,d.mimeType(e.src))}).then(function(t){return new Promise(function(n,r){e.onload=n,e.onerror=r,e.src=t})})}return{inline:t}}function t(n){return n instanceof Element?function(e){var t=e.style.getPropertyValue("background");return t?h.inlineAll(t).then(function(t){e.style.setProperty("background",t,e.style.getPropertyPriority("background"))}).then(function(){return e}):Promise.resolve(e)}(n).then(function(){return n instanceof HTMLImageElement?e(n).inline():Promise.all(d.asArray(n.childNodes).map(function(e){return t(e)}))}):Promise.resolve(n)}return{inlineAll:t,impl:{newImage:e}}}(),g={toSvg:n,toPng:o,toJpeg:i,toBlob:u,toPixelData:r,impl:{fontFaces:p,images:m,util:d,inliner:h}};e.exports=g}()},function(e,t){e.exports=angular},function(e,t,n){n(0),e.exports=n(1)}]);